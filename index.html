<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>Anthony Bourdain Travel Destinations</title>
    <style>
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        height: 90%;
      }
      /* Optional: Makes the sample page fill the window. */
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
  </head>
  <body>
    <center><h1>Anthony Bourdain Travel Destinations</h1></center>
    <div id="map"></div>
    <script>

      function initMap() {

        var map = new google.maps.Map(document.getElementById('map'), {
          zoom: 3,
          center: {lat: 22.681, lng: -34.805} //22.681097, -34.805607
        });

        // Add some markers to the map.
        // Note: The code uses the JavaScript Array.prototype.map() method to
        // create an array of markers based on a given "locations" array.
        // The map() method here has nothing to do with the Google Maps API.
        /*var markers = locations.map(function(location, i) {
          return new google.maps.Marker({
            position: location,
            //label: labels[i % labels.length]
            label: 'your text here'
          });
        });*/

        /*var infowindow1 = new google.maps.InfoWindow({
          content: '<p>More Info About Richmond</p>'
        });

        var marker1 = new google.maps.Marker({
          position: {lat: 37.565, lng: -77.431},
          //label: 'Richmond',
          map: map
        });
        marker1.addListener('click', function() {
          infowindow1.open(map, marker1);
        });

        var marker2 = new google.maps.Marker({
          position: {lat: 25.479, lng: -78.165},
          label: 'Everglades1',
          map: map
        });

        var marker3 = new google.maps.Marker({
          position: {lat: 25.479, lng: -78.170},
          label: 'Everglades2',
          map: map
        });

        var marker4 = new google.maps.Marker({
          position: {lat: 25.479, lng: -78.175},
          label: 'Everglades3',
          map: map
        });

        var marker5 = new google.maps.Marker({
          position: {lat: 25.479, lng: -78.180},
          label: 'Everglades4',
          map: map
        });

        var markers = [marker1, marker2, marker3, marker4, marker5];*/


        var markers = [];
        var infowindow = new google.maps.InfoWindow; // Make global InfoWindow so that only one displays at a time


        function addMarkers(location, map, placeName) {
          infowindow = new google.maps.InfoWindow({
            content: '<p>More Info About <b>' + placeName + '</b></p>'
          }); // Create the text window
          var marker = new google.maps.Marker({
            position: location,
            map: map
          }); // Create the marker
          markers.push(marker); // Add to array of markers
          marker.addListener('click', function() {
            infowindow.open(map, marker);
            infowindow.setContent('<p><b>' + placeName + '</b></p>');
          }); // onClickListener for text window
        }

        // Loop through data files to add place info
        //addMarkers({lat: 37.538526, lng: -77.455155}, map, 'Richmond');
        //addMarkers({lat: 25.479, lng: -78.165}, map, 'Everglades1');
        //addMarkers({lat: 25.479, lng: -78.170}, map, 'Everglades2');
        //addMarkers({lat: 25.479, lng: -78.175}, map, 'Everglades3');
        //addMarkers({lat: 25.479, lng: -78.180}, map, 'Everglades4');

        

        //file:///Users/alexanderpowell/Desktop/bourdain-app/models/data.txt
        function readTextFile(file)
        {
            var rawFile = new XMLHttpRequest();
            rawFile.open("GET", file, false);
            var places = null;
            rawFile.onreadystatechange = function ()
            {
                if(rawFile.readyState === 4)
                {
                    if(rawFile.status === 200 || rawFile.status == 0)
                    {
                        var allText = rawFile.responseText;
                        places = allText.split('\n');

                    }
                }
            }
            rawFile.send(null);
            return places;
        }

        var rows = readTextFile('https://raw.githubusercontent.com/alexanderjpowell/bourdain-travel-destinations/master/data.txt');

        for (var i = 1; i < rows.length; i++) { // Start at 1 to ignore column headers
          var data = rows[i].split('|');
          if (data.length != 3) {
            break;
          }
          addMarkers({lat: Number(data[0]), lng: Number(data[1])}, map, data[2]);
        }

        //var rows = readTextFile('https://raw.githubusercontent.com/alexanderjpowell/bourdain-travel-destinations/master/data.txt');
        //console.log(rows);
        //alert(rows[0]);

        // Add a marker clusterer to manage the markers.
        var markerCluster = new MarkerClusterer(map, markers,
            // this path needs to be changed before deployment - path should point to a url containing all 5 image cluster icons
            {imagePath: 'https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m'});


      }

    </script>
    <!--<script src="https://github.com/googlemaps/v3-utility-library/blob/master/markerclusterer/src/markerclusterer.js">-->
    <script src="markerclusterer.js">
    </script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBaHk1vy_lGcnV9ZI8zrpkwSV5vs_NFWZk&callback=initMap">
    </script>
  </body>
</html>












